id: org.freedesktop.Sdk.Extension.debugpy
default-branch: 20.08
sdk: org.freedesktop.Sdk//20.08
runtime: org.freedesktop.Sdk
runtime-version: 20.08
build-extension: true
appstream-compose: false
modules:

  - name: debugpy
    buildsystem: simple
    build-options:
        build-args:
            - "--share=network"
    build-commands:
      - pip3 install --prefix=/usr/lib/sdk/debugpy .
      - install -Dm 755 wrapper.sh /usr/lib/sdk/debugpy/bin/debugpy
    sources:
      - type: git
        url: https://github.com/microsoft/debugpy
        branch: main
      - type: script
        dest-filename: wrapper.sh
        commands:
          - PYTHONPATH=/usr/lib/sdk/debugpy/lib/python3.8/site-packages /usr/bin/python3 -m debugpy.adapter

  - name: metadata
    buildsystem: simple
    build-commands:
      - install -Dm644 -t ${FLATPAK_DEST}/share/metainfo ${FLATPAK_ID}.metainfo.xml
      - appstream-compose --basename=${FLATPAK_ID} --prefix=${FLATPAK_DEST} --origin=flatpak ${FLATPAK_ID}
    sources:
      - type: file
        path: org.freedesktop.Sdk.Extension.debugpy.metainfo.xml
